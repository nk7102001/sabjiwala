<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Reports & Analytics - Sabjiwala</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-50 min-h-screen flex flex-col font-sans">

  <!-- ✅ Navbar -->
  <%- include('../partials/navbar') %>

  <!-- Main Content -->
  <main class="flex-grow w-full px-3 sm:px-6 lg:px-8 py-6 sm:py-10" role="main" aria-labelledby="pageTitle">

    <!-- Page Title -->
    <h1 id="pageTitle" class="text-2xl sm:text-3xl font-extrabold text-green-700 mb-6 sm:mb-8">
      Admin Reports & Analytics
    </h1>

    <!-- Stats & Lists -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 sm:gap-6 mb-10">

      <!-- Total Sales -->
      <div class="bg-white shadow-md p-5 sm:p-6 rounded-lg hover:shadow-lg transition">
        <p class="text-gray-600 font-semibold mb-2">Total Sales</p>
        <p class="text-2xl sm:text-3xl font-bold text-blue-600">
          ₹<%= (typeof totalSales === 'number' ? totalSales : 0).toFixed(2) %>
        </p>
      </div>

      <!-- Top 5 Products -->
      <div class="bg-white shadow-md p-5 sm:p-6 rounded-lg hover:shadow-lg transition">
        <p class="text-gray-600 font-semibold mb-2">Top 5 Products (by Qty)</p>
        <% const _topProducts = Array.isArray(topProducts) ? topProducts : []; %>
        <% if (_topProducts.length === 0) { %>
          <p class="text-gray-500 text-sm sm:text-base">No product data available.</p>
        <% } else { %>
          <ul class="list-disc list-inside space-y-1 text-sm sm:text-base">
            <% _topProducts.forEach((p) => { %>
              <li>
                <%= p.name || 'Unnamed Product' %> —
                <span class="font-bold text-green-600">
                  <%= Number(p.totalQty || 0) %> kg
                </span>
              </li>
            <% }); %>
          </ul>
        <% } %>
      </div>

      <!-- Top 5 Sellers -->
      <div class="bg-white shadow-md p-5 sm:p-6 rounded-lg hover:shadow-lg transition">
        <p class="text-gray-600 font-semibold mb-2">Top 5 Sellers (by Earnings)</p>
        <% const _topSellers = Array.isArray(topSellers) ? topSellers : []; %>
        <% if (_topSellers.length === 0) { %>
          <p class="text-gray-500 text-sm sm:text-base">No seller data available.</p>
        <% } else { %>
          <ul class="list-disc list-inside space-y-1 text-sm sm:text-base">
            <% _topSellers.forEach((s) => { %>
              <li>
                <%= s.shopName || s.name || 'Seller' %> —
                <span class="font-bold text-blue-600">
                  ₹<%= Number(s.totalEarnings || 0).toFixed(2) %>
                </span>
              </li>
            <% }); %>
          </ul>
        <% } %>
      </div>
    </div>

    <!-- Future: Chart -->
    <!--
    <div class="bg-white shadow-md rounded-lg p-6">
      Chart.js or ApexCharts code can go here in future
    </div>
    -->

    <!-- Back Button -->
    <a href="/admin/dashboard"
       class="inline-block mt-6 sm:mt-8 text-green-700 underline hover:text-green-900 text-sm sm:text-base">
      ← Back to Dashboard
    </a>

  </main>

  <!-- ✅ Footer -->
  <%- include('../partials/footer') %>

</body>
</html>
